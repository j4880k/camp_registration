<h1>Reservations</h1>
<!-- %= link_to "Go Back to Main Page", root_path % -->
<br/>
<% if @reservations.empty? %>

	<h2> You haven't made any reservations yet </h2>

<% else %>

	<table>
	  <tr>
	    <th>Person</th>
	    <th>Event</th>
		<th>Dates</th>
	    <!-- <th>Is deleted</th> -->
	    <!-- <th>Is staffing</th> -->
	    <!-- <th>Notes</th> -->
	    <!-- <th>Discount</th> -->
	    <!-- <th>Cost</th> -->
		<th>Price</th>
		<th>Status</th>
	    <th></th>
	    <th></th>
		<th></th>
		<th></th>
	  </tr>

	<% @reservations.each do |reservation| %>
	  <tr>
	    <td><%= reservation.person.firstname %> <%= reservation.person.lastname %> (<%= reservation.person.nickname %>)</td>
	    <td><%= reservation.event.eventname %></td>
		<td><%= reservation.event.event_dates%></td>
	    <!-- <td><%= reservation.is_deleted %></td> -->
	    <!-- <td><%= reservation.is_staffing %></td> -->
	    <!-- <td><%= reservation.notes %></td> -->
	    <!-- <td><%= reservation.all_discounts %></td> -->
	    <!-- <td><%= reservation.amountpaid %></td> -->
		<td><%= reservation.amount_due %></td>
		<% if reservation.reservation_cart.try(:status) == 'new'%>
			<td>Added to cart</td>
		<% else %>
			<td><%= reservation.reservation_cart.try(:status) %></td>
		<% end %>
	    <td><%= link_to 'Show', reservation %></td>
		<td>
		<% if can? :update, reservation %>
			<% unless reservation.locked==true %>
	    		<%= link_to 'Edit', edit_reservation_path(reservation) %>
			<% end %>
		<% end %>
		</td>
		<td>
			<% if (reservation.reservation_cart.nil?) and (reservation.locked != true) %>
			 <%= link_to "Add to cart", {:controller=>"reservations", :id=>reservation.id, :action=>"add_to_cart"}, :method=>"post" %>
			<% end %>			
		</td>
		<td>
		<% if can? :destroy, reservation %>
	    	<%= link_to 'Destroy', reservation, confirm: 'Are you sure?', method: :delete %>
		<% end %>
		</td>
	  </tr>
	<% end %>
	</table>
<% end %>
<br />

<%= link_to 'New Reservation', new_reservation_path %>
